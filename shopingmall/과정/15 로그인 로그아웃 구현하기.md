로그인 로그아웃 구현하기
===


UserDetailsService
===

UserDetailsService 인터페이스는 데이터베이스에서 회원 정보를 가져오는 역할을 담당합니다.

loadUserByUsername() 메소드가 존재하며, 회원 정보를 조회하여 사용자의 정보와 권한을 갖는 UserDetails 인터페이스를 반환합니다.

스프링부트에서는 UserDetailsService를 통해서 구현하고 있는 클래스로 로그인 기능을 구현한다고 생각하시면 됩니다.

UserDetail
===

스프링 시큐리티에서 회원의 정보를 담기 위해서 사용하는 인터페이스는 UserDetails 이다.

이 인터페이스를 직접 구현하거나 스프링 시큐리티에서 제공하는 User 클래스를 사용한다. User 클래스는 UserDetails 인터페이슬ㄹ

구현하고 있는 클래스이다.

로그인/로그아웃 구현을 위해 MemberService가 UserDetailsService를 구현해보겠습니다.

MemberService
====

    @Service
    @Transactional
    @RequiredArgsConstructor
    public class MemberService implements UserDetailsService {//1

    코드생략
        @Override
        public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {//2

            Member member = memberRepository.findByEmail(email);

            if(member == null){
                throw new UsernameNotFoundException(email);
            }

            return User.builder()//3
                    .username(member.getEmail())
                    .password(member.getPassword())
                    .roles(member.getRole().toString())
                    .build();
        }

    }
    
    
1 MemberService가 UserDetailsService를 구현한다.

2 UserDetailsService 인터페이스의 loadUserByUsername() 메소드를 오버라이딩 합니다. 

로그인할 유저의 email을 파라미터로 전달받는다.

3 UserDetail을 구현하고 있는 User 객체를 반환해줍니다.

User 객체를 생성하기 위해서 생성자로 회원의 이메일, 비밀번호를 role을 파라미터로 넘겨준다.

SecurityConfig
===




