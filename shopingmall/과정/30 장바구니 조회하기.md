장바구니 조회하기
===

먼저 장부구니 조회 페이지에 전달할 DTO 클래스를 생성하겠습니다

CartDetailDto
===

        import lombok.Getter;
        import lombok.Setter;

        @Getter @Setter
        public class CartDetailDto {

            private Long cartItemId; //장바구니 상품 아이디

            private String itemNm; //상품명

            private int price; //상품 금액

            private int count; //수량

            private String imgUrl; //상품 이미지 경로

            public CartDetailDto(Long cartItemId, String itemNm, int price, int count, String imgUrl){//1
                this.cartItemId = cartItemId;
                this.itemNm = itemNm;
                this.price = price;
                this.count = count;
                this.imgUrl = imgUrl;
            }

        }

//1 장바구니 페이지에 전달할 데이터를 생성자의 파라미터로 만들어줍니다.

CartItemRepository
===

장바구니 페이지에 전달할 CartDetailDto 리스트를 쿼리 하나로 조회하는 JPQL문을 작성합니다.

코드
===

        import com.shop.entity.CartItem;
        import org.springframework.data.jpa.repository.JpaRepository;

        import com.shop.dto.CartDetailDto;
        import org.springframework.data.jpa.repository.Query;
        import java.util.List;

        public interface CartItemRepository extends JpaRepository<CartItem, Long> {

            CartItem findByCartIdAndItemId(Long cartId, Long itemId);

            @Query("select new com.shop.dto.CartDetailDto(ci.id, i.itemNm, i.price, ci.count, im.imgUrl) " +//1
                    "from CartItem ci, ItemImg im " +
                    "join ci.item i " +
                    "where ci.cart.id = :cartId " +
                    "and im.item.id = ci.item.id " +//2
                    "and im.repimgYn = 'Y' " +//3
                    "order by ci.regTime desc"
                    )
            List<CartDetailDto> findCartDetailDtoList(Long cartId);

        }


/*



*/
